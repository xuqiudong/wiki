---
title: 04-redis常见问题
description: redis常见问题收集
published: true
date: 2023-09-11T09:38:35.970Z
tags: redis, 咕泡, 面试
editor: markdown
dateCreated: 2023-09-08T09:40:11.104Z
---

# 04-redis常见问题
 
 ## 01 对redis的理解
 1. Redis 是一个高性能的基于 Key-Value 结构存储的 Nosql 开源数据库。
 2. 一般采用 Redis 来实现分布式缓存，从而提高数据的检索效率。
 3. Redis 之所以这么流行，主要有几个特点：
   - 基于内存存储，在进行数据 IO 操作时，能够 10WQPS
   - 提供了非常丰富的数据存储结构，如 String、List、Hash、Set、ZSet 等。
   -  底层采用单线程实现数据的 IO，所以在数据算法层面并不需要要考虑并发安全性，所以底层算法上的时间复杂度基本上都是常量
4. Redis 虽然是内存存储，但是它也可以支持持久化，避免因为服务器故障导致数据丢失的问题

`基于这些特点，Redis 一般用来实现分布式缓存，从而降低应用程序对关系型数据库检索带来的性能影响。除此之外，Redis 还可以实现分布式锁、分布式队列、排行榜、查找附近的人等功能，为复杂应用提供非常方便和成熟的解决方案`

## 02 Redis 为什么这么快
1. 决定 Redis 请求效率的因素主要是三个方面，分别是网络、cpu、内存。
2. 在网络层面，Redis 采用**多路复用**的设计，提升了并发处理的连接数，不过这个阶段，Server 端的所有 IO 操作，都是由同一个主线程处理的这个时候 IO 的瓶颈就会影响到 Redis 端的整体处理性能。所以从 Redis6.0 开始，在多路复用及层面增加了多线程的处理，来优化 IO 处理的能力。不过，具体的数据操作仍然是由主线程来处理的，所以我们可以认为 Redis 对于数据 IO的处理依然是单线程。
3. 从 CPU 层面来说，Redis 只需要采用单线程即可，原因有两个。
 - 3.1 如果采用多线程，对于 Redis 中的数据操作，都需要通过同步的方式来保证线程安全性，这反而会影响到 redis 的性能
 - 3.2 在 Linux 系统上 Redis 通过 pipelining 可以处理 100w 个请求每秒，而应用程序的计算复杂度主要是 O(N) 或 O(log(N)) ，不会消耗太多 CPU；
4.  从内存层面来说，Redis 本身就是一个内存数据库，内存的 IO 速度本身就很快，所以内存的瓶颈只是受限于内存大小
5. 最后， Redis 本身的数据结构也做了很多的优化，比如压缩表、跳跃表等方式降低了时间复杂读，同时还提供了不同时间复杂度的数据类型。使得开发人员能够有更多合适的选择。

## 03 Redis 和 Mysql 如何保证数据一致性
1. 一般先更新数据库，再更新缓存，或者 先删除缓存，再更新数据库，但是都可能存在不一致性
2. 在极端情况下仍然保证 Redis 和 Mysql 的数据一致性，就只能采用最终一致性方案。
  - 2.1 比如基于 RocketMQ 的可靠性消息通信，来实现最终一致性。（更新失败的请求写入mq，同步到redis）
  - 2.2 直接通过 Canal 组件，监控 Mysql 中 binlog 的日志，把更新后的数据同步到 Redis 里面。
3. 通过读写锁的方式来保证强一致性  ：在数据更新的时候，其他任何请求都无法访问缓存中的数据，直到数据更新完毕，从而保证了数据的强一致性

